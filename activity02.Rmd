---
title: "activity02"
output: html_document
date: "`r Sys.Date`"
editor_options: 
  markdown: 
    wrap: sentence
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidymodels)
library(ggplot2)
```

### The data

The data we're working with is from the OpenIntro site: `https://www.openintro.org/data/csv/hfi.csv`.
Here is the "about" page: <https://www.openintro.org/data/index.php?data=hfi>.

In the R code chunk below titled `load-data`, you will type the code that reads in the above linked CSV file by doing the following:

-   Rather than downloading this file, uploading to RStudio, then reading it in, explore how to load this file directly from the provided URL with `readr::read_csv` (`{readr}` is part of `{tidyverse}`).
-   Assign this data set into a data frame named `hfi` (short for "Human Freedom Index").

```{r load data}
hfi <- read_csv("hfi.csv")
hfi
```

1.  What are the dimensions of the dataset? What does each row represent?

```{r}
dimensions <- dim(hfi)
rows <- dimensions[1]
columns <- dimensions[2]

# Print the dimensions
cat("The dataset has", rows, "rows and", columns, "columns.\n")
```

The dataset spans a lot of years.
We are only interested in data from year 2016.
In the R code chunk below titled `hfi-2016`, type the code that does the following:

-   Filter the data `hfi` data frame for year 2016, and
-   Assigns the result to a data frame named `hfi_2016`.

```{r hfi-2016}
library(dplyr)

# Filter the data for year 2016 and assign it to hfi_2016
hfi_2016 <- hfi |>
  filter(year == 2016)
hfi_2016
```

### 1. Identify our research question(s)

The research question is often defined by you (or your company, boss, etc.).
Today's research question/goal is to predict a country's personal freedom score in 2016.

For this activity we want to explore the relationship between the personal freedom score, `pf_score`, and the political pressures and controls on media content index,`pf_expression_control`.
Specifically, we are going to use the political pressures and controls on media content index to predict a country's personal freedom score in 2016.

### 2. Explore the variables of interest

Answer the following questions (use your markdown skills) and complete the following tasks.

2.  What type of plot would you use to display the distribution of the personal freedom scores, `pf_score`? Would this be the same type of plot to display the distribution of the political pressures and controls on media content index, `pf_expression_control`?

**A histogram would be an effective choice. A histogram allows us to see the frequency distribution of pf_score across different ranges, helping us understand its central tendency, spread, and the presence of any skewness or outliers.**

-   In the R code chunk below titled `univariable-plots`, type the R code that displays this plot for `pf_score`.
-   In the R code chunk below titled `univariable-plots`, type the R code that displays this plot for `pf_expression_control`.

```{r distribution-plots}

# Histogram for pf_score
ggplot(hfi_2016, aes(x = pf_score)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black") +
  labs(title = "Distribution of Personal Freedom Scores",
       x = "Personal Freedom Score",
       y = "Frequency") +
  theme_minimal()

# Histogram for pf_expression_control
ggplot(hfi_2016, aes(x = pf_expression_control)) +
  geom_histogram(binwidth = 1, fill = "green", color = "black") +
  labs(title = "Distribution of Political Pressures and Controls on Media Content Index",
       x = "Political Pressures and Controls on Media Content Index",
       y = "Frequency") +
  theme_minimal()
```
4.  Comment on each of these two distributions. Be sure to describe their centers, spread, shape, and any potential outliers.
**The pf_score is left skewed and does not have an outlier. The pf_expression_control is a bimodal and does not have an outlier.**

5.  What type of plot would you use to display the relationship between the personal freedom score, `pf_score`, and the political pressures and controls on media content index,`pf_expression_control`?

**To display the relationship between the personal freedom score (pf_score) and the political pressures and controls on media content index (pf_expression_control), a scatter plot would be an appropriate choice. Scatter plots allow us to visualize the relationship between two continuous variables and can help identify patterns, correlations, and potential outliers.**

-   In the R code chunk below titled `relationship-plot`, plot this relationship using the variable `pf_expression_control` as the predictor/explanatory variable.

```{r relationship-plot}
# Scatter plot to display the relationship between pf_score and pf_expression_control
ggplot(hfi_2016, aes(x = pf_expression_control, y = pf_score)) +
  geom_point(color = "blue") +
  labs(title = "Relationship between Personal Freedom Score and Political Pressures and Controls on Media Content Index",
       x = "Political Pressures and Controls on Media Content Index",
       y = "Personal Freedom Score") +
  theme_minimal()
```

4.  Does the relationship look linear? If you knew a country's `pf_expression_control`, or its score out of 10, with 0 being the most, of political pressures and controls on media content, would you be comfortable using a linear model to predict the personal freedom score?

#### Challenge

For each plot and using your `{dplyr}` skills, obtain the appropriate numerical summary statistics and provide more detailed descriptions of these plots. For example, in (4) you were asked to comment on the center, spread, shape, and potential outliers. What measures could/should be used to describe these? You might not know of one for each of those terms.

What numerical summary would you use to describe the relationship between two numerical variables? (hint: explore the `cor` function from Base R)

```{r challenge}

```

## 3. Fit a simple linear regression model

Regardless of your response to (4), we will continue fitting a simple linear regression (SLR) model to these data. The code that we will be using to fit statistical models in this course use `{tidymodels}` - an opinionated way to fit models in R - and this is likely new to most of you. I will provide you with example code when I do not think you should know what to do - i.e., anything `{tidymodels}` related.

To begin, we will create a `{parsnip}` specification for a linear model.

-   In the code chunk below titled `parsnip-spec`, replace "verbatim" with "r" just before the code chunk title.

```{verbatim parsnip-spec}
lm_spec <- linear_reg() %>%
  set_mode("regression") %>%
  set_engine("lm")

lm_spec
```

Note that the `set_mode("regression")` is really unnecessary/redundant as linear models (`"lm"`) can only be regression models. It is better to be explicit as we get comfortable with this new process. Remember that you can type `?function_name` in the R **Console** to explore a function's help documentation.

The above code also outputs the `lm_spec` output. This code does not do any calculations by itself, but rather specifies what we plan to do.

Using this specification, we can now fit our model: $\texttt{pf\\_score} = \beta_0 + \beta_1 \times \texttt{pf\\_expression\\_control} + \varepsilon$. Note, the "\$" portion in the previous sentence is LaTeX snytex which is a math scripting (and other scripting) language. I do not expect you to know this, but you will become more comfortable with this. Look at your knitted document to see how this syntax appears.

-   In the code chunk below titled `fit-lm`, replace "verbatim" with "r" just before the code chunk title.

```{r fit-lm}
slr_mod <- lm_spec %>% 
  fit(pf_score ~ pf_expression_control, data = hfi_2016)

tidy(slr_mod)
```

The above code fits our SLR model, then provides a `tidy` parameter estimates table.

5.  Using the `tidy` output, update the below formula with the estimated parameters. That is, replace "intercept" and "slope" with the appropriate values

$\widehat{\texttt{pf\\_score}} = intercept + slope \times \texttt{pf\\_expression\\_control}$

6.  Interpret each of the estimated parameters from (5) in the context of this research question. That is, what do these values represent?
